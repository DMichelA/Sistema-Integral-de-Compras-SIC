{% extends 'base/base.html' %}

{% load static %}

{% block title %}
Requisicion | Descarga
{% endblock %}


{% block menu %}
<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
    <a class= "navbar-brand"><img src="{% static 'img/sicutec.png' %}" height="35px" width="auto" alt=""></a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
        <li class="nav-item active">
        <a class="nav-link" href="{% url 'usuario_index' %}">Home <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-grid" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
        </svg><span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
        <a class="nav-link" href="{% url 'logout' %}?next={% url 'login' %}">Cerrar Sesión <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-box-arrow-left" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"/>
            <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
        </svg></a>
        </li>
        <li class="nav-item dropdown">
        <!--
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Dropdown
        </a>
        -->
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
            <a class="dropdown-item" href="#">Action</a>
            <a class="dropdown-item" href="#">Another action</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="{% url 'logout' %}?next={% url 'login' %}">Cerrar sesion</a>
        </div>
        </li>
    </ul>
    </div>
</nav>
{% endblock %}



{% block content %}

<form method="POST">
    {% csrf_token %}
    <br>
    <div class="table-responsive">
        <table class="table table-bordered table table-sm">
            <thead>
                <th>Encabezado General</th>
                <th colspan="4">A.Nombre del formato:</th>
            </thead>
            <thead class="text-center">
                <th><img src="{% static 'img/sicutec.png' %}" height="50px" width="200px"></th>
                <th colspan="4" style="font-size:29px;">REQUISICIÓN DE BIENES Y SERVICIOS</th>
            </thead>
            <thead>
                <th WIDTH="100">F-22-01-R1;210817</th>
                <th colspan="2">B. Código/Revisión; Fecha:</th>
                <th colspan="3">F-16-09-R5;270319</th>
            </thead>
            <tbody>
                <th>Datos para los Registros (Evidencia):</th>
                <th colspan="1">C. Página</th>
                <td>1</td>
                <th colspan="1">De</th>
                <td>1</td>
            </tbody>
            <tbody>
                <th>D. Fecha de elaboración:</th>
                <td class="text-center"><fieldset disabled="disabled">{{form.fecha_elaboracion}}</fieldset></td>
                <th>E. Periodo al que se aplica:</th>
                <td colspan="2" class="text-center;"><fieldset disabled="disabled">{{form.periodo}}</fieldset></td>
            </tbody>
            <tr>
                <td style="border: 1 ;" colspan="5" HEIGHT="20"></td>
            </tr>
            <tbody>
                <th colspan="3" style="font-size:larger;" class="font-weight-bold text-center">RECURSOS MATERIALES Y SERVICIOS GENERALES.</th>
                <th>1. Folio:</th>
                <td colspan="1"><fieldset disabled="disabled">{{form.folio}}</fieldset></td>
            </tbody>
            <tr>
                <th>2. Fecha que se requiere el bien o servicio: (dd/mm/aaaa)</th>
                <td><fieldset disabled="disabled">{{form.fecha_requerida}}</fieldset></td>
                <td>
                    <table WIDTH=100%>
                        <th>3. Núm. de contrato:</th>
                        <td class="text-center"><fieldset disabled="disabled">{{form.num_contrato}}</fieldset></td>
                    </table>
                </td>
                <td>
                    <table WIDTH=100% HEIGHT="100">
                        <th class="text-center">4. Prioridad:</th>
                    </table>
                </td>
                <td>
                <fieldset disabled="disabled">
                {{form.prioridad}}
                </fieldset>
                </td>
            </tr>
            <tr>
                <td>
                    <table WIDTH=100%>
                        <tr>6. Proyecto:</tr>
                        <td class="text-center"><fieldset disabled="disabled">{{form.proyecto}}</fieldset></td>
                    </table>
                </td>
                <td colspan="4">
                    <table WIDTH=100%>
                        <th>7. Nombre y Firma del líder del proyecto:</th>
                        <tr>
                            <td class="text-center"><fieldset disabled="disabled">{{form.nombre_lider}}</fieldset></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="5" HEIGHT="10"></td>
            </tr>
            <tr>
                <th class="text-center" colspan="5">8. JUSTIFICACIÓN:</th>
            </tr>
                    <tr>
                        <td colspan="5" HEIGHT="60"><fieldset disabled="disabled">{{form.justificacion}}</fieldset></td>
                    </tr>
                    <tr>
                        <td colspan="5" HEIGHT="10"></td>
                    </tr>
            <tr HEIGHT="100">
                <td colspan="5">
                    <table WIDTH=100% HEIGHT="20" style="margin: 0 auto;">
                        <thead>
                            <th>9. Clave (Rec. Mat.)</th>
                            <th>10. Partida (Progr. Y Pres.)</th>
                            <th>11. Cantidad</th>
                            <th>12. Unidad de Medida</td>
                            <th>13. Concepto</th>
                            <th>14. Especificaciones Técnicas</th>
                            <th>15. Costo Unitario Aproximado</th>
                            <th>16. Subtotal</th>
                        </thead>
                        <tbody>
                            {% if bienes %}
                            {% for bien in bienes %}
                            <tr>
                                <td>{{ bien.id }}</td>
                                <td>{{ bien.codigo_partida }}</td>
                                <td>{{ bien.cantidad_bienes }}</td>
                                <td>{{ bien.unidad_medida }}</td>
                                <td>{{ bien.descrip_general_bien }}</td>
                                <td>{{ bien.espeficaciones_tecnicas }}</td>
                                <td>{{ bien.precio_unitario }}</td>
                                <td>{{ bien.total }}</td>
                            </tr>
                            {% endfor %}
                            {% else %}
                            <h1>No hay bien</h1>
                            {% endif %}
                        </tbody>
                        <!--Traer bien de BD-->
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan="4" WIDTH=50%>
                    <table WIDTH=100% HEIGHT="20" style="margin: 0 auto;">
                        <thead>
                            <th colspan="4" class="text-center">AUTORIZACIÓN DE PROGRAMACIÓN Y PRESUPUESTO</th>
                        </thead>
                        <thead>
                            <th>17. Total del Gasto:</th>
                            <th>18. Máximo Autorizado:</th>
                            <th>19. Proyecto:</th>
                            <th>20. Fuente de financiamiento:</th>
                        </thead>
                        <tr HEIGHT="20">
                            <td rowspan="3"><fieldset disabled="disabled">{{form.autorizacion_totalgasto}}</fieldset></td>
                            <td><fieldset disabled="disabled">{{form.max_autorizadoFE}}</fieldset></td>
                            <td><fieldset disabled="disabled">{{form.presupuesto_proyectoFE}}</fieldset></td>
                            <td class="text-center font-weight-bold">Federal</td>
                        </tr>
                        <tr HEIGHT="20">
                            <td><fieldset disabled="disabled">{{form.max_autorizadoES}}</fieldset></td>
                            <td><fieldset disabled="disabled">{{form.presupuesto_proyectoES}}</fieldset></td>
                            <td class="text-center font-weight-bold">Estatal</td>
                        </tr>
                        <tr HEIGHT="20">
                            <td><fieldset disabled="disabled">{{form.max_autorizadoIP}}</fieldset></td>
                            <td><fieldset disabled="disabled">{{form.presupuesto_proyectoIP}}</fieldset></td>
                            <td class="text-center font-weight-bold">IP</td>
                        </tr>
                        <tr>
                            <th class="text-center">21. FIRMA DE AUTORIZACIÓN:</th>
                            <td colspan="4"><fieldset disabled="disabled">{{form.firma_autorizacion}}</fieldset></td>
                        </tr>
                    </table>
                </td>
                <td>
                    <table WIDTH=100% HEIGHT="40" style="margin: 0 auto;">
                        <tr>
                            <th class="text-center">22. OBSERVACIONES:</th>
                        </tr>
                        <tr>
                            <td HEIGHT="150"><fieldset disabled="disabled">{{form.observaciones}}</fieldset></td>
                        </tr>
                    </table>
                </td>
                <tr>
                    <td colspan="4">
                        <table WIDTH=100% HEIGHT="40" style="margin: 0 auto;">
                            <tr>
                                <th class="text-center">23. NOMBRE Y FIRMA DE ENCARGADA DE ADMINISTRACIÓN Y FINANZAS:</th>
                            </tr>
                            <tr>
                                <td HEIGHT="50"><fieldset disabled="disabled">{{form.firma_encargadafinanzas}}</fieldset></td>
                            </tr>
                        </table>
                    </td>
                <td>
                    <table WIDTH=100% HEIGHT="40" style="margin: 0 auto;">
                        <thead>
                            <th class="text-center">24. NOMBRE Y FIRMA DEL RECTOR:</th>
                        </thead>
                        <tr>
                            <td HEIGHT="50"><fieldset disabled="disabled">{{form.firma_rector}}</fieldset></td>
                        </tr>
                    </table>
                </td>
                <thead>
                    <th class="text-center" colspan="2">25.NOMBRE Y FIRMAS DE CONFORMIDAD Y FECHA</th>
                    <td colspan="4"><fieldset disabled="disabled">{{form.firmas_conformidad}}</fieldset></td>
                </thead>
                <thead>
                    <th colspan="6" class="text-center">NOTA: </th>
                </thead>
                <tbody>
                    <td colspan="6" style="text-align: center;" HEIGHT="50">
                        En caso de ser monto mayores de 300 veces la UMA se deberá de verificar el procedimiento de
                        adjudicación: DIRECTA, INVITACIÓN O LICITACIÓN,
                        dependiendo de ello será el tiempo de entrega, conforme lo estipula la Ley en la materia, y
                        el área usuario deberá requisitar el anexo técnico.
                    </td>
                </tbody>
        </table><br>
    </div>

    <div class="row">
        <div class="col text-center">
            <button class="btn btn-primary" id="descargar" type= "button" onclick="descarga()">Descargar</button>
        </div>
    </div><br>
</form>

{% endblock %}

{% block scriptcode %}
<script>

    function descarga(){
        let promy = new Promise((resolve, reject)=>{
            document.getElementById("descargar").style.display="none";
        resolve(1)
        }).then(res=>{
        if (res==1){
          window.print();
        }
      })
    }

</script>
{% endblock %}